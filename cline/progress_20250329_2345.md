# Clarity PoC - Progress Report (Updated 2025-04-03)

## Objective
Develop a working proof of concept (PoC) for the ADHD-focused planning tool "Clarity". Core goals include a mind-dump input, AI-driven categorization (Tasks, Events, Ideas, Feelings, Notes) with time-based priority, an organized view, and a simple daily planner structured by priority, with simulated reminders.

## Initial Setup & Troubleshooting
- Started with `ixartz/Next-js-Boilerplate`.
- Encountered significant issues cloning and running the boilerplate (empty directories, missing `package.json`, environment variable errors, i18n/middleware conflicts, layout issues).
- Multiple attempts to fix the boilerplate setup were unsuccessful.

## Fresh Start
- Decided to abandon the boilerplate and start with a fresh Next.js installation (`create-next-app`).
- Successfully initialized a new project with TypeScript, Tailwind, ESLint, App Router, and `src` directory.
- Resolved initial permission errors by running `create-next-app` in the main macOS terminal.

## Core Implementation (Fresh Project)
- **Environment:** Created `.env.local` for the Google API key.
- **Dependencies:** Installed base Next.js dependencies, `@google/generative-ai`, and `@types/node`. Resolved module resolution errors via clean install and correct saving to `package.json`.
- **API Route (`/api/categorise`):**
    - Created the route handler (`src/app/api/categorise/route.ts`).
    - Implemented logic to receive text input via POST.
    - Integrated Google Generative AI SDK (`@google/generative-ai`).
    - Configured to use the `gemini-1.5-flash-latest` model (after troubleshooting `gemini-pro` and `gemini-1.0-pro`).
    - Added prompt engineering to request categorization into specified types (task, event, idea, feeling, note) **and assign a numerical priority (1-5) based on time-of-day/flexibility**, returning structured JSON.
    - Included basic error handling and JSON parsing logic.
- **Components:**
    - `MindDumpInput.tsx`: Created component with textarea and submit button to call the API. Includes loading and error state handling.
    - `OrganizedView.tsx`: Created component to display categorized entries grouped by type, sorted logically. Includes icons.
    - `DailyPlanner.tsx`: Created component to display 'task' items, allow simple text input for time slots, and simulate reminders using `alert` and `setTimeout`. Includes logic to preserve time slots when entries update. Includes basic drag-and-drop sorting capability.
- **Page Integration:**
    - Updated the default `src/app/page.tsx` to integrate the three components (`MindDumpInput`, `OrganizedView`, `DailyPlanner`) and manage the state flow between them.
- **Configuration & Structure:**
    - Removed boilerplate i18n logic (`next-intl`) from `middleware.ts`, `next.config.ts`, root layout, and directory structure.
    - Removed boilerplate Clerk authentication logic from `middleware.ts` and environment validation (`src/libs/Env.ts` - *Note: This file was likely removed during the fresh start, but the principle was applied*).
    - Created a basic `tailwind.config.ts`.
    - Created a root `src/app/layout.tsx` and removed specific layouts for simplicity.
    - Added favicons to `/public/favicons` and configured them in `src/app/layout.tsx`.
    - Added `.cline` directory for project documentation.
    - Added `project_overview.md` combining roadmap and spec.
    - Configured git remote origin.
- **Styling:**
    *   Applied light/dark mode styling based on user-provided images (blue theme for light, dark theme).
    *   Removed explanatory comments added during styling.

## Current Status (End of Session 2025-03-30)
- Phase 1 (Foundation & PoC) core features are implemented in the fresh Next.js project.
- The application runs locally (`npm run dev`) on `http://localhost:3000`.
- Core flow (input -> API call -> categorization -> display -> basic planning) is functional.
- Basic light and dark mode styling is applied.
- Project documentation (`project_overview.md`, `progress_report.md`) initiated in `.cline`.
- Git remote configured.
- **Frontend Priority Integration:** Updated types and components (`page.tsx`, `MindDumpInput.tsx`, `OrganizedView.tsx`, `DailyPlanner.tsx`) to handle and display tasks based on API-provided priority (grouping in Daily Planner).
- **Editable Categories (Phase 2 Start):** Implemented UI (`OrganizedView.tsx`) and state management (`page.tsx`) to allow users to change the AI-assigned category via a dropdown. *(Added 2025-04-05)*

## Current Status & Next Steps (Updated 2025-04-05)
1.  **Testing & Refinement:** *(Completed)*
    *   Core user flow tested.
    *   AI categorization/priority verified.
    *   Planner functionality (drag/drop, time input, reminders) tested.
    *   Styling confirmed.
    *   Editable category functionality tested. *(Added 2025-04-05)*
2.  **Documentation:** *(Partially Complete)*
    *   `README.md` updated with current setup/run instructions. *(Done)*
    *   Code comments were added and then reverted per user request. *(Reverted)*
    *   Progress report updated with editable category implementation. *(Done 2025-04-05)*
3.  **(Phase 2 - Next) Enhanced Task Prioritization:** Explore UI for *manual* priority adjustments or more advanced AI suggestions (beyond the current time-based assignment). *(Marked complete via drag-and-drop 2025-04-06)*

## Phase 2 Continuation (Session 2025-04-06)
- **Start/End Time Refactor:**
    - Updated `Entry` type (`src/types/index.ts`) to replace `eventTimestamp` with optional `startTime` and `endTime`.
    - Updated `EntriesContext` (`src/context/EntriesContext.tsx`) with handlers (`handleUpdateStartTime`, `handleUpdateEndTime`).
    - Updated Entry Detail Page (`src/app/entry/[id]/page.tsx`) to display and allow editing of `startTime` and `endTime`.
    - Updated `DailyPlanner.tsx` to display `startTime`/`endTime` for tasks.
    - Updated relevant tests (`DailyPlanner.test.tsx`, `EntriesContext.test.tsx`, `[id]/page.test.tsx` - *assuming tests exist*) to reflect the data structure changes.
- **Calendar View Implementation:**
    - Added view switching tabs ("List View" / "Calendar") within `DailyPlanner.tsx`.
    - Implemented `AgendaView.tsx` component rendered under the "Calendar" tab.
    - Implemented `MonthNavigator.tsx` using `react-calendar` library (switched from `react-day-picker` due to styling issues).
    - Implemented `DailyChronologicalList.tsx` to display entries for the selected date.
    - Updated `DailyPlanner.test.tsx` to handle the new view and library.
    - Updated Jest config (`jest.config.cjs`) to correctly handle `react-calendar` CSS.
- **Documentation Updates:**
    - Updated `cline/session-plan.md` and `cline/project_overview.md` to mark completed Phase 2 tasks (Calendar View, Prioritization) and remove Daily Summary from scope.
    - Updated this progress report.

## Current Status & Next Steps (End of Session 2025-04-06)
- Phase 2 core features (Editable Categories, Basic Prioritization, List/Calendar View Toggle, Calendar View) are implemented.
- Next logical step is moving to Phase 3: Persistence & Portability (User Accounts, Database Integration).
